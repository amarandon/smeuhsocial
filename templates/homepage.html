{% extends "site_base.html" %}

{% load i18n %}
{% load ifsetting_tag %}
{% load threadedcommentstags %}
{% load override_tags %}
{% load group_tags %}
{% load blog_tags %}

{% block head_title %}{% trans "Welcome" %}{% endblock %}

{% block body_class %}home{% endblock %}

{% block body %}
    
    <h1>Bienvenue dans votre Smeuh</h1>
    
    <p>
        Le but de ce site est de permettre aux
        adhérents et sympatisants de <a href="http://smeuh.org">Smeuh.Org</a>
        d'échanger et de publier des photos, des idées, des liens,
        éventuellement un jour du son, etc.
    </p>
    <p>
      Pour en savoir plus sur le code qui fait tourner ce site, signaler des
      bugs et
      éventuellement contribuer, c'est <a
        href="https://github.com/alex-marandon/smeuhsocial">par ici</a>.
    </p>


      {% get_latest_comments 10 as latest_comments %}
      <div id="homepage-left-col">
        <h2>{% blocktrans %}Latest comments{% endblocktrans %}</h2>
        {% for comment in latest_comments %}
        <div class="latest-comment-entry">
                    {% profile_link comment.user %} on <a href="{{ comment.content_object.get_absolute_url }}">{{ comment.content_object.title }}</a> <span class="comment-blurb-date">{% blocktrans with comment.date_modified|timesince as tweet_age %}{{ tweet_age }} ago{% endblocktrans %}</span>

          <div class="comment-blurb">{{ comment.comment|truncatewords:30 }}</div>
        </div>
        {% endfor %}
      </div>

      <div id="homepage-right-col">
        <div class="latest-photos">
          <h2>{% blocktrans %}Latest photos{% endblocktrans %}</h2>
          {% for photo in latest_photos%}
            <a href="{% groupurl photo_details group id=photo.id %}"><img src="{{ photo.get_thumbnail_url }}" alt="{{ photo.title }}"/></a>
          {% endfor %}
          <div class="homepage-view-more">
            <a href="{% url photos %}">{% blocktrans %}View more{% endblocktrans %}</a>
          </div>
        </div>
        <div class="latest-tweets">
          <h2>{% blocktrans %}Latest tweets{% endblocktrans %}</h2>
          {% for tweet in latest_tweets%}
              {% include "microblogging/_tweet.html" %}
          {% endfor %}
          <div class="homepage-view-more">
            <a href="{% url all_tweets %}">{% blocktrans %}View more{% endblocktrans %}</a>
          </div>
        </div>
        <div class="latest-blogs">
          <h2>{% blocktrans %}Latest blog posts{% endblocktrans %}</h2>
          {% for blog_post in latest_blogs%}
          <a href="{{ blog_post.get_absolute_url }}">{{ blog_post.title }}</a> 
          by {% profile_link blog_post.author %}<br>
          {% endfor %}
          <div class="homepage-view-more">
            <a href="{% url blog_list_all %}">{% blocktrans %}View more{% endblocktrans %}</a>
          </div>
        </div>
        <div class="latest-tracks">
          <h2>{% blocktrans %}Latest tracks{% endblocktrans %}</h2>
          {% for track in latest_tracks%}
          <a href="{{ track.get_absolute_url }}">{{ track.title }}</a> 
          by {% profile_link track.user %}<br>
          {% endfor %}
          <div class="homepage-view-more">
            <a href="{% url audiotracks %}">{% blocktrans %}View more{% endblocktrans %}</a>
          </div>
        </div>
      </div>
    <div class="clear"></div>

    
    <hr />
    {% if user.is_authenticated %}
        {% url what_next as what_next_url %}
        <p class="what_next">{% blocktrans %}Wondering <a href="{{ what_next_url }}">What Next</a>?{% endblocktrans %}</p>
    {% else %}
        {% url acct_login as login_url %}
        {% ifsetting ACCOUNT_OPEN_SIGNUP %}
            {% url acct_signup as signup_url %}
            <p>{% blocktrans %}You can <a href="{{ signup_url }}">Sign up</a> and <a href="{{ login_url }}">Log in</a> to try out the site.{% endblocktrans %}</p>
        {% else %}
            <p>{% blocktrans %}You can <a href="{{ login_url }}">Log in</a> to try out the site.{% endblocktrans %}</p>
        {% endifsetting %}
    {% endif %}
    
{% endblock %}
